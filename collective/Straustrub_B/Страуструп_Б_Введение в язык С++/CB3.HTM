<html><head>
<title>Borland C++Builder 3: новые возможности создания корпоративных информационных систем</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="../../PICTURES/MENU/HEADER0.JPG" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="../../PICTURES/MENU/LOGO.GIF" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>
<p>&nbsp;
<center>
<h3>Borland C++Builder 3: новые возможности создания корпоративных информационных систем.</h3>
Наталия Елманова
</center>
<p>
<a href=#1>Средства создания многозвенных систем</a><br>
<a href=#2>Дополительные инструменты</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href=#21>BDE Administrator</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href=#22>SQL Explorer</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href=#23>SQL BuilderM</a><br>
<a href=#4>Компоненты для создания систем принятия решений</a><br>
<a href=#5>Возможности публикации данных в Internet</a><br>
<p align="justify">За год существования С++Builder у этого продукта появилось немало сторонников. Сочетание универсального языка программирования, являющегося, по существу, индустриальным стандартом, комфортной среды разработки, зарекомендовавшей себя еще до появления самого С++Builder, возможности быстрой разработки приложений с минимальным использованием ручного кодирования, удобного и универсального механизма доступа к данным сделали этот продукт весьма привлекательным для разработчиков и менеджеров информационных систем.
<p align="justify">Появления новой версии разработчики ждали давно - с момента выхода Delphi 3, обладавшей набором интересных и полезных возможностей, отсутствовавших в первой версии C++Builder. Теперь  можно с уверенностью сказать, что новый С++Builder оправдал ожидания разработчиков: он не только предоставляет те же возможности, что и Delphi 3, но и довольно широкий спектр дополнительных возможностей, пользователям Delphi пока неизвестных.  В данной статье будут рассмотрены наиболее интересные особенности C++Builder 3.0, связанные с созданием информационных систем.
<a name=1></a>
<h4>Средства создания многозвенных систем.</h4>
<p align="justify">Говоря о С++Builder как об инструменте создания корпоративных информационных систем, в том числе ИС масштаба предприятия, следует остановиться на такой замечательной возможности, как средства создания серверов приложений и "тонких" клиентов. В комплект поставки версии C++Builder Client/Server Suite входит MIDAS Development Kit, представляющий собой набор компонентов и брокеров middleware, позволяющих создавать и отлаживать серверы приложений и использующие их клиентские приложения. Иными словами, С++Builder, наравне с Delphi, теперь также поддерживает MIDAS. 
<p align="justify">Простейший  MIDAS-ориентированный сервер приложений можно создать буквально за несколько минут. Для этого достаточно выбрать из репозитория объектов C++Builder пиктограмму Remote DataModule и в удаленный  модуль данных поместить какой-либо компонент доступа к данным (например, TTable или TQuery), установить значения его свойств DatabaseName и TableName (или SQL), установить значение его свойства Active равным true. Затем нужно экспортировать его из модуля данных (рис….), выбрав соответствующую опцию контекстного меню, а затем скомпилировать и выполнить созданное приложение, чтобы зарегистрировать его в реестре . Далее следует запустить приложение scktsrvr.exe (Borland MIDAS Socket Server), чтобы сервер приложений мог быть запущен удаленно по протоколу TCP/IP.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_1.GIF" width=629 height=422 border=0 alt="Библиотека типов, связанная с удаленным модулем данных">
<p><i>Рис.1. Библиотека типов, связанная с удаленным модулем данных</i>
</center>
<p align="justify">Теперь можно создать клиентское приложение (причем не обязательно на том же самом компьютере - главное, чтобы компьютер с сервером приложений был доступен по протоколу TCP/IP), поместив на форму компоненты TMidasConnection,  TClientDataSet, связанный с ним компонент TDataSource и связанные с ним интерфейсные элементы для отображения данных (например, TDBGrid). У компонента TMidasConnection следует установить значение свойства ComputerName  равным IP-адресу компьютера, на котором находится сервер приложений, свойства ServerName равным имени сервера приложений (в формате <имя исполняемого файла>.<имя OLE-сервера>), а свойства ConnectType равным TCP/IP. Затем свойство Connected можно установить равным true, и сервер приложений после этого должен запуститься удаленно. Теперь можно установить значение свойства  RemoteServer компонента  TClientDataSet равным имени компонента TMidasConnection, а также значение свойства ProviderName равным имени экспортированного объекта из удаленного модуля данных сервера приложений. Осталось установить свойство Active этого компонента равным true, вызвать в каком-нибудь обработчике событий метод ApplyUpdates компонента TClientDataSet - и простейший "тонкий" клиент готов! 
<center>
<p><img src="../../PICTURES/IT/CB3/CB_2.GIF" width=458 height=336 border=0 alt="&quot;Тонкий&quot; клиент">
<p><i>Рис.2. "Тонкий" клиент</i>
</center>
<p align="justify">Следует отметить, что в C++Builder, так же как и в Delphi, имеется возможность создания активных форм - для этой цели используется библиотека Active Template Library. Этим можно воспользоваться для создания "тонкого" клиента, отображаемого в броузере, и не требующего предварительной установки, наcтройки и конфигурации, но имеющего, в отличие от  Web-приложений типа CGI или ISAPI,  полноценный Windows-интерфейс.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_3.GIF" width=697 height=679 border=0 alt="&quot;Тонкий&quot; клиент в виде ActiveX">
<p><i>Рис.3. "Тонкий" клиент в виде ActiveX</i>
</center>
<p align="justify">Что дает использование трехзвенных информационных систем? Об их преимуществах сказано уже немало. Во-первых, "тонкий" клиент, подобный рассмотренному выше, не требует наличия на рабочей станции ни клиентской части серверной СУБД, ни библиотеки Borland Database Engine, и, соответственно, не требует конфигурации клиентской части и настройки BDE.  Единственное, что требуется на рабочей станции - наличие библиотеки dbclient.dll размером 140 Кб, которую можно поставлять вместе с клиентским приложением. Во-вторых, для такого клиентского приложения требуется  меньше ресурсов, чем для классического "толстого" клиента. В-третьих, вместо создания дистрибутива достаточно скопировать на рабочую станцию исполняемый файл и dbclient.dll (или загрузить в Internet Explorer web-страницу с компонентом ActiveX).  Таким образом, налицо прямое снижение затрат, связанных с конфигурацией рабочих станций и  ресурсоемкостью клиентских приложений.
<p align="justify">Помимо перечисленных очевидных преимуществ трехзвенной архитектуры, MIDAS также предоставляет  дополнительные возможности повышения надежности используемой информационной системы. Например, при наличии в сети нескольких однотипных серверов приложений сбой одного из таких серверов приведет к  распределению подключенных к нему "тонких" клиентов  по другим серверам - это сделает Busiess ObjectBroker. Он же обеспечивает и равномерную загрузку серверов приложений клиентскими соединениями.
<p align="justify">Но это еще не все. Именно трехзвенная архитектура позволяет реально осуществить централизацию хранения и обработки данных с одновременным доступом к актуальной информации в случае, когда рабочая станция находится на значительном расстоянии от сервера приложений, исключающем прокладку локальной сети, так как доступ к серверу приложений может осуществляться и иными способами, такими, как модемное соединение или доступ через Internet.  Требования к надежности такого соединения невысоки, так как при использовании подобной архитектуры активно применяется кэширование данных на рабочей станции, и при этом использование ConstraintBroker позволяет проверять соответствие изменяемых данных правилам сервера непосредственно на рабочей станции, поэтому применение "тонких" клиентов и серверов приложений, управляемых MIDAS, является  наилучшим решением для территориально разбросанных предприятий, организаций  с удаленными филиалами, в том числе в других городах и странах.
<p align="justify">Отметим, однако, что MIDAS Development Kit позволяет лишь создавать и отлаживать серверы приложений.  Входящий в его состав ConstraintBroker обладает ограниченным временем действия, а Business ObjectBroker обладает ограничением на число экспортируемых OLE-объектов.  Только полнофункциональная версия MIDAS позволяет использовать эти брокеры без подобных ограничений (и не нарушать при этом лицензионные соглашения).
<p align="justify">Отметим, что возможности создания многозвенных систем ограничиваются не только MIDAS-ориентированными серверами. Наряду с версией C++Builder Client/Server Suite имеется версия C++Builder Enterprise, позволяющая создавать "тонкие" клиентские приложения для сервера приложений Borland Entera c помощью компонентов TEnteraConnection и TEnteraProvider. Отметим, что Entera существует для большого количества платформ, что позволяет создавать многоуровневые системы в гетерогенной среде, где не только серверы баз данных, но и серверы приложений функционируют на платформах, отличных от Windows (например, на UNIX-платформах), что позволяет выбрать наиболее оптимальное для предприятия сочетание удобства, масштабируемости и надежности.  
<a name=2></a>
<h4>Дополительные инструменты</h4>
<a name=21></a>
<p><font size="+1">BDE Administrator</font>
<p align="justify">В комплект поставки C++Builder теперь входит новая версия утилиты конфигурации BDE - BDE Administrator, устанавливающаяся теперь в панель управления Windows. Эта утилита обладает более удобным интерфейсом и  некоторыми полезными возможностями по сравнению с утилитой конфигурации BDE из прежней версии C++Builder. Во-первых, в процессе конфигурации доступа к серверным СУБД она позволяет вызвать утилиты из состава клиентской части серверной СУБД, например, консольные приложения для интерактивной работы с SQL, такие, как SQL Plus из клиентской части Oracle 7 или Interactive SQL из клиентской части IB Database, утилиты для установки и конфигурации клиентской части, ODBC-администратор и т.д.. Во-вторых, эта утилита считывает  конфигурационые файлы клиентских частей серверных СУБД (такие, как TNSNAMES.ORA для Oracle 7) и при выборе серверной СУБД предлагает список доступных баз данных из этих файлов. В-третьих, эта утилита позволяет проверить корректность настроек псевдонимов путем установки соединения с базой данных и не требует запуска для этой цели других приложений, как это было в прежней версии С++Builder.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_4.GIF" width=654 height=683 border=0 alt="BDE Administrator">
<p><i>Рис.4. BDE Administrator</i>
</center>
<a name=22></a>
<p><font size="+1">SQL Explorer</font>
<p align="justify">Значительные изменения по сравнению с прежней версией претерпела и утилита  SQL Explorer. Теперь с ее помощью можно не только просматривать, но и создавать и редактировать объекты серверных СУБД, такие как таблицы, индексы, триггеры, хранимые процедуры, серверные ограничения (Constraints), представления (Views), табличные области и другие объекты серверных СУБД.  Фактически новая версия SQL Explorer представляет собой удобную и простую утилиту администрирования одновременно всех имеющихся в доступности баз данных, что по достоинству могут оценить менеджеры информационных систем, содержащих несколько различных СУБД, например, одновременно Oracle, IB Database и таблицы Paradox.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_5.GIF" width=681 height=536 border=0 alt="SQL Explorer">
<p>Рис. 5.  SQL Explorer
</center>
<a name=23></a>
<p><font size="+1">SQL Builder</font>
<p align="justify">В  C++Builder 3.0 включено новое средство построения SQL-запросов - SQL Builder, заменивший Visual Query Builder, входивший в комплект поставки прежней версии, а также всех версий Delphi.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_6.GIF" width=652 height=399 border=0 alt="SQL Builder">
<p><i>Рис. 6.  SQL Builder</i>
</center>
<p align="justify">Этот инструмент отличается  более удобными по сравнению с Visual Query Builder визуальными средствами редактирования запросов,  а также возможностью редактирования текста запроса. При этом возможна синхронизация визуального представления с отредактированным текстом, если последний не содержит ошибок.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_7.GIF" width=475 height=236 border=0 alt="Редактор текста запросов  SQL Builder">
<p><i>Рис. 7. Редактор текста запросов  SQL Builder</i>
</center>
<p align="justify">Отметим также, что возможно выполнение созданного запроса непосредственно из SQL Builder, что позволяет проверить правильность его построения.
<a name=4></a>
<h4>Компоненты для создания систем принятия решений.</h4>
<p align="justify">Среди компонентов, связанных с использованием баз данных,  появилась группа Decision Cube для создания систем поддержки принятия решений. Эти компоненты применяются при создании приложений, используемых менеджерами высшего звена и предназначенных для многомерного анализа данных.	 Decision Cube представляет собой набор многомерных кросс-таблиц, содержащих агрегатные данные, вычисленные на основе какого-либо запроса. Компонент TDecisionGrid позволяет просматривать различные двумерные и трехмерные сечения такого куба как на этапе проектирования приложения, так и на этапе выполнения, а компонент TDecisionGraph - создать  диаграмму, соответствующую текущему сечению. 
<center>
<p><img src="../../PICTURES/IT/CB3/CB_8.GIF" width=732 height=457 border=0 alt="Decision Cube">
<p><i>Рис.8. Decision Cube</i>
</center>
<p align="justify">Сами данные выбираются из таблиц с помощью компонента TDecisionQuery, обладающего редактором свойств, позволяющим визуально построить запрос с агрегатными данными, в том числе с использованием SQL Builder. 
<center>
<p><img src="../../PICTURES/IT/CB3/CB_9.GIF" width=426 height=346 border=0 alt="Редактор свойств компонента TDecisionQuery">
<p><i>Рис.9. Редактор свойств компонента TDecisionQuery</i>
</center>
<p align="justify">Для обмена многомерными данными между TDecisionQuery и компонентами отображения многомерных данных TDecisionGraph и TDecisionGrid используется компонент TDecisionSource - аналог компонента TDataSource.
<p align="justify">Управлять отображением сечений можно с помощью компонента TDecisionPivot либо путем "сворачивания" и "разворачивания" размерностей непосредственно в компоненте TDecisionGrid.
<center>
<p><img src="../../PICTURES/IT/CB3/CB_10.GIF" width=732 height=457 border=0 alt="Управление отображением сечений ">
<p><i>Рис.10. Управление отображением сечений </i>
</center>
<a name=5></a>
<h4>Возможности публикации данных в Internet.</h4>
<p align="justify">Для создания web-приложений можно, как известно, использовать абсолютно любое средство разработки, лишь бы полученное приложение было способно выполняться в той операционной системе, под управлением которой функционирует web-сервер. Поэтому, говоря о создании таких приложений, было бы преувеличением сказать, что до появления C++Builder 3 такой возможности не было - создать, например, динамически загружаемую библиотеку, являющуюся расширением Internet Information Server или Netscape Fast Track (т.е. web-приложение в стандарте ISAPI/NSAPI) с успехом можно было и с помощью C++Builder 1.0, а CGI-приложения, как показывает опыт российских разработчиков, без особых проблем создаются с помощью Clipper, FoxPro и даже с помощью обычных командных файлов.  Однако такие приложения так или иначе требуют написания некоторого количества кода, и вопрос удобства того или иного средства разработки так или иначе связан с желанием минимизировать рутинную работу, связанную с процессом "ручного" кодирования. И в этом отношении C++Builder 3.0 является весьма удобным средством разработки, так как обладает неплохими возможностями визуального проектирования подобного рода приложений. 
<p align="justify">Среди доступных разработчику средств визуальной разработки web-приложений хотелось бы особо отметить  средства, позволяющие осуществлять публикацию данных в Internet. Для этой цели используются компоненты TDataSetTableProducer и TDataSetQueryTableProducer, получающие данные из компонента TTable или TQuery и представляющие их в виде HTML-документа в табличном виде (рис. 11). 
<center>
<p><img src="../../PICTURES/IT/CB3/CB_11.GIF" width=621 height=513 border=0 alt="Редактор свойств компонента TDataSetTableProducer ">
<p><i>Рис.11. Редактор свойств компонента TDataSetTableProducer</i>
</center>
<p align="justify">Пример подобной публикации данных в Internet, созданный сотрудниками Борланд АО (прайс-лист, передаваемый в броузер с помощью динамически загружаемой библиотеки в стандарте NSAPI), можно найти по адресу http://www.borland.ru.
<p align="justify">Отметим также, что сама возможность размещения в объекте TWebModule компонентов доступа к данным существенно облегчает создание CGI-приложений, связанных как с публикацией данных, так и с обработкой пользовательского ввода (например, в HTML-формах), заключающегося в изменении или добавлении данных. Типичными примерами таких приложений являются анкеты, которые в изобилии встречаются на многих web-серверах. 
<p align="justify">Помимо этого, публикация данных возможна также с помощью так называемых шаблонов - HTML-документов, содержащих специальные теги, заменяемые в процессе формирования HTML-страницы строками, которые, в свою очередь, могут быть получены путем выполнения запроса к базе данных.
<p align="justify">В заключение хотелось бы отметить, что новые возможности эффективной разработки информационных систем, предоставляемые C++Builder, отнюдь не ограничиваются перечисленными в данной статье нововведениями, хотя и представляются наиболее интересными.
<p align="justify">В ближайших статьях цикла, посвященного C++Builder, эти возможности будут рассмотрены более подробно.
<p>Координаты автора:<br>
Центр Информационных Технологий,<br>
Тел. (095)932-92-12, 932-92-13,<br>
<a href="mailto:elmanova@citmgu.ru">elmanova@citmgu.ru</a>,<br>
<a href="http://www.citmgu.ru">http://www.citmgu.ru</a>, <br>
<a href="http://www.citforum.ru">http://www.citforum.ru</a>
<p>&nbsp;
<table cellspacing=0 cellpadding=0 border=0 background="../../PICTURES/MENU/FOOTER0.JPG" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table></body></html>