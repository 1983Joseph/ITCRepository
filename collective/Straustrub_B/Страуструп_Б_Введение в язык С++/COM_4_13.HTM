<html><head>
<title>1.3 Как осуществить удаленный доступ - Использование COM-технологии в C++Builder</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="../../PICTURES/MENU/HEADER0.JPG" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="../../PICTURES/MENU/LOGO.GIF" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>
<h4><i>1.3 Как осуществить удаленный доступ</i></h4>
<p align=justify>Итак, для осуществления удаленного запуска сервера автоматизации следует запустить на стороне компьютера-сервера Service Control Manager, предварительно сконфигурировав его так, чтобы удаленный пользователь мог осуществить запуск данного сервера.
<p align=justify><b>Использование Microsoft DCOM в качестве Service Control Manager</b>
<p align=justify>Рассмотрим использование Microsoft DCOM в качестве Service Control Manager. Для конфигурации DCOM существует утилита DCOMCNFG, входящая в комплект поставки Windows NT. 
<p align=justify>Использование DCOM в качестве SCM базируется на предоставлении прав на удаленный запуск  конкретного приложения тем или иным пользователям или группам пользователей. Поэтому компьютер, содержащий сервер, который планируется запускать удаленно, должен иметь в своем реестре описание прав доступа к данному серверу различных пользователей или их групп. 
<center>
<p><img src="../../PICTURES/IT/COM_4/COM_4_03.GIF" width=476 height=494 border=0 alt="Настройка прав доступа к серверу автоматизации">
<p><i>Рис.3. Настройка прав доступа к серверу автоматизации</i>
</center>
<p align=justify>Для этого требуется, в свою очередь, экспорт сведений о пользователях сети с первичного контроллера домена, что возможно только в случае выбора на таком компьютере установки User Level Access Control раздела Network панели управления Windows.
<p align=justify>В реестре компьютера, на котором запускается контроллер автоматизации, также должны содержаться сведения о том, что соответствующий сервер автоматизации запускается удаленно. Для этого нужно, чтобы в реестре о сервере автоматизации уже была соответствующая запись, поэтому нужно его хотя бы один раз запустить локально (или перенести соответствующие записи из реестра компьютера, содержащего сервер, на компьютер, содержащий контроллер).
<p align=justify>После этого можно с помощью той же утилиты DCOMCNFG указать, что данное приложение запускается удаленно:
<center>
<p><img src="../../PICTURES/IT/COM_4/COM_4_04.GIF" width=419 height=448 border=0 alt="Настройка удаленного запуска приложения-сервера">
<p><i>Рис. 4. Настройка удаленного запуска приложения-сервера</i>
</center>
<p align=justify>После этого можно попытаться запустить контроллер. Сервер при этом запустится удаленно.
<p align=justify>Хотелось бы особо обратить внимание на достоинства и недостатки использования DCOM в качестве SCM. Несомненным достоинством этого способа является то, что DCOM интегрирован в операционную систему Windows NT и не требует установки и запуска каких-либо утилит для своего функционирования. Недостатки же этого способа удаленного запуска серверов автоматизации таковы:
<ul>
<li>В сети обязательно должен быть первичный контроллер домена
<li>Могут потребоваться существенные изменения настроек сети (для установки опции User Level Access Control)
<li>Сервер автоматизации нужно хотя бы один раз запустить на компьютере с контроллером для его регистрации
</ul>
<p align=justify>Помимо этого, есть определенные сомнения в возможности использования Windows 95 в качестве операционной системы для компьютера, содержащего удаленный сервер автоматизации. По крайней мере, на сегодняшний день автору неизвестны успешные случаи удаленного запуска подобных серверов на компьютерах, оснащенных этой операционной системой, с помощью DCOM. Использование в этом качестве Windows 98 автором не проверялось.
<p align=justify><b>Использование Inprise OLEnterprise в качестве Service Control Manager</b>
<p align=justify>Рассмотрим альтернативный способ запуска удаленных серверов автоматизации, использующий в качестве Service Control Manager продукт OLEnterprise (Inprise Corporation), входящий в комплект поставки C++Builder Client/Server Suite.
<p align=justify>Использование OLEnterprise в качестве SCM базируется на предоставлении прав на удаленный запуск  конкретного приложения всем пользователям, имеющим установленную клиентскую часть этого продукта. В первую очередь следует запустить на компьютере, содержащем сервер автоматизации, утилиту Object Factory, которая, по существу, и выполняет роль SCM. Предоставление прав на запуск сервера владельцем компьютера, содержащего этот сервер, осуществляется путем публикации соответствующих записей реестра (или, в терминах OLEnterprise, экспорта соответствующего сервера автоматизации в глобальный реестр), с помощью утилиты Object Explorer:
<center> 
<p><img src="../../PICTURES/IT/COM_4/COM_4_05.GIF" width=603 height=362 border=0 alt="Публикация сведений о приложении-сервере в глобальном реестре">
<p><i>Рис. 5. Публикация сведений о приложении-сервере в глобальном реестре</i>
</center>
<p align=justify>На компьютере, содержащем контроллер, с помощью этой же утилиты можно соединиться с удаленным реестром компьютера, содержащего сервер автоматизации и импортировать запись о нем в собственный реестр:
<center>  
<p><img src="../../PICTURES/IT/COM_4/COM_4_06.GIF" width=574 height=299 border=0 alt="Импорт записи из глобального реестра в реестр компьютера, содержащего контроллер автоматизации">
<p><i>Рис. 6. Импорт записи из глобального реестра в реестр компьютера, содержащего контроллер автоматизации</i>
</center>
<p align=justify>После этого при запуске контроллера сервер запустится удаленно.
<p align=justify>В данном примере компьютер, на котором запускается контроллер автоматизации, "знает" об одном единственном компьютере, содержащем сервер (точно так же, как и в рассмотренном выше примере использования DCOM).  Однако возможности OLEnterprise этим не исчерпываются.  В комплект его поставки входит утилита Business ObjectBroker, назначение которой - взаимодействовать с опубликованными частями реестров сети в поисках сервера автоматизации для обратившихся к нему клиентов. Если сконфигурировать OLEnterprise так, чтобы использовать Business ObjectBroker, клиенты автоматизации  должны обращаться к нему, а не непосредственно к  серверам автоматизации, как в предыдущем случае. В ответ они будут получать указание, с каким из компьютеров сети соединиться для использования сервера автоматизации. 
<p align=justify>Если компьютеров, опубликовавших в глобальном реестре сведения об одном и том же сервере автоматизации, несколько, обращения компьютеров, содержащих контроллеры, будут распределены между ними случайным образом, что позволяет равномерно распределить нагрузку на эти компьютеры.
<p align=justify>Рассмотрим  достоинства и недостатки использования OLEnterprise в качестве SCM.  Достоинства этого способа очевидны: наличие первичного контроллера домена в сети в этом случае не является обязательным, существенных изменений настроек сети не требуется, сервер автоматизации не нужно запускать на компьютере, содержащем контроллер. Имеется возможность запускать удаленные серверы автоматизации под управлением Windows 95. Помимо этого, можно иметь несколько дублирующих друг друга серверов автоматизации на разных компьютерах сети, и можно написать код контроллера таким образом, чтобы в случае сбоя используемого сервера данный контроллер с помощью Business ObjectBroker  данный компьютер был подключен к другому компьютеру, содержащему сервер, что повышает надежность такой системы. Отметим, что в случае использования DCOM это практически невозможно - в настройках DCOM местоположение сервера всегда указывается явно, а использование брокеров не предусмотрено.
<p align=justify>Недостатки у этого способа тоже есть - в отличие от DCOM, автоматически устанавливающегося вместе c Windows NT, OLEnterprise требует отдельного приобретения и установки, в том числе установки клиентской части OLEnterprise на компьютеры, содержащие  контроллеры автоматизации. 
<p align=justify>Отметим, что список возможных SCM отнюдь не исчерпывается DCOM и OLEnterprise. Помимо них, возможно использование других подобных резидентных утилит, позволяющих  при тех или иных условиях запускать удаленным пользователям серверы автоматизации. Например, Borland Socket Server, входящий в комплект поставки C++Builder Client/Server Suite, является еще одним типом SCM и позволяет запускать определенные типы серверов автоматизации, не требуя при этом  на компьютере, содержащем контроллер, никаких дополнительных клиентских частей и настроек.
<center>
<p><font size="-1"><a href="COM_4_12.HTM">Назад</a> |
 <a href=COM_4.HTM>Содержание</a> |
 <a href="COM_4_20.HTM">Вперед</a>
</font></center>
&nbsp;
<table cellspacing=0 cellpadding=0 border=0 background="../../PICTURES/MENU/FOOTER0.JPG" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table></body></html>